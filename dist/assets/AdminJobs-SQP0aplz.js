import{d as Z,u as ee,r as d,x as le,m as te,c as b,a as _,n as ae,e as t,w as a,g as i,p as oe,y as w,s as T,o as u,k as r,F as x,z,i as S,t as D,h as ne,E as se,A as E,_ as ie}from"./index-riSBzU23.js";const re={class:"page-container"},ue={class:"header-actions mb-4 flex justify-between"},de={class:"filter-bar"},me={class:"pagination"},pe={class:"dialog-footer"},ve=Z({__name:"AdminJobs",setup(fe){const A=ne(),y=ee(),U=d(!1),J=d([]),M=d(0),p=d(1),k=d(20),v=d(!1),h=d(!1),B=d(!1),g=d({}),n=le({city:"",level:"",skill:"",industry:"",degree:"",min_years:void 0}),f=async()=>{U.value=!0;try{const o={...n,page:p.value,pageSize:k.value};Object.keys(o).forEach(s=>{(o[s]===""||o[s]===void 0)&&delete o[s]});const e=await T.getJobs(o);if(e.error){console.error(e.error);return}J.value=e.data.items,M.value=e.data.total}catch(o){console.error(o)}finally{U.value=!1}},$=()=>{p.value=1,f()},F=()=>{n.city="",n.level="",n.skill="",n.industry="",n.degree="",n.min_years=void 0,$()},N=o=>{p.value=o,f()},I=o=>{k.value=o,p.value=1,f()},L=o=>{A.push(`/jobs/${o}`)},O=()=>{h.value=!1,g.value={title:"",city_id:null,min_years:0,level_id:null,salary_min:0,salary_max:0},v.value=!0},R=o=>{h.value=!0,g.value={...o},v.value=!0},q=async o=>{try{await se.confirm("确定要删除该职位吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const{error:e}=await T.deleteJob(o.id);if(e)throw e;E.success("删除成功"),f()}catch(e){e!=="cancel"&&E.error("删除失败: "+(e.message||e))}},G=async()=>{B.value=!0;try{await new Promise(o=>setTimeout(o,500)),E.success("保存功能待完善 (需要完善表单)"),v.value=!1,f()}finally{B.value=!1}};return te(()=>{y.fetchMeta(),f()}),(o,e)=>{const s=i("el-button"),V=i("el-option"),C=i("el-select"),c=i("el-form-item"),j=i("el-form"),m=i("el-table-column"),H=i("el-tag"),K=i("el-table"),Q=i("el-pagination"),W=i("el-input"),X=i("el-dialog"),Y=oe("loading");return u(),b("div",re,[_("div",ue,[e[10]||(e[10]=_("h2",null,"岗位管理",-1)),t(s,{type:"primary",onClick:O},{default:a(()=>[...e[9]||(e[9]=[r("发布职位",-1)])]),_:1})]),_("div",de,[t(j,{inline:!0,model:n,class:"demo-form-inline"},{default:a(()=>[t(c,{label:"城市"},{default:a(()=>[t(C,{modelValue:n.city,"onUpdate:modelValue":e[0]||(e[0]=l=>n.city=l),placeholder:"选择城市",clearable:""},{default:a(()=>[(u(!0),b(x,null,z(S(y).cities,l=>(u(),w(V,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"职级"},{default:a(()=>[t(C,{modelValue:n.level,"onUpdate:modelValue":e[1]||(e[1]=l=>n.level=l),placeholder:"选择职级",clearable:""},{default:a(()=>[(u(!0),b(x,null,z(S(y).levels,l=>(u(),w(V,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"技能"},{default:a(()=>[t(C,{modelValue:n.skill,"onUpdate:modelValue":e[2]||(e[2]=l=>n.skill=l),placeholder:"要求技能",clearable:""},{default:a(()=>[(u(!0),b(x,null,z(S(y).skills,l=>(u(),w(V,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"行业"},{default:a(()=>[t(C,{modelValue:n.industry,"onUpdate:modelValue":e[3]||(e[3]=l=>n.industry=l),placeholder:"所属行业",clearable:""},{default:a(()=>[(u(!0),b(x,null,z(S(y).industries,l=>(u(),w(V,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:a(()=>[t(s,{type:"primary",onClick:$},{default:a(()=>[...e[11]||(e[11]=[r("筛选",-1)])]),_:1}),t(s,{onClick:F},{default:a(()=>[...e[12]||(e[12]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),ae((u(),w(K,{data:J.value,style:{width:"100%"},stripe:""},{default:a(()=>[t(m,{prop:"id",label:"ID",width:"80"}),t(m,{prop:"title",label:"职位名称",width:"180"}),t(m,{prop:"city",label:"城市",width:"100"}),t(m,{prop:"min_years",label:"最低年限",width:"100"},{default:a(l=>[r(D(l.row.min_years)+"年 ",1)]),_:1}),t(m,{prop:"level",label:"职级",width:"100"},{default:a(l=>[t(H,{type:"success"},{default:a(()=>[r(D(l.row.level),1)]),_:2},1024)]),_:1}),t(m,{label:"薪资范围",width:"150"},{default:a(l=>[r(D(l.row.salary_min)+" - "+D(l.row.salary_max),1)]),_:1}),t(m,{label:"操作",width:"250",fixed:"right"},{default:a(l=>[t(s,{size:"small",onClick:P=>L(l.row.id)},{default:a(()=>[...e[13]||(e[13]=[r("查看",-1)])]),_:1},8,["onClick"]),t(s,{type:"primary",size:"small",onClick:P=>R(l.row)},{default:a(()=>[...e[14]||(e[14]=[r("编辑",-1)])]),_:1},8,["onClick"]),t(s,{type:"danger",size:"small",onClick:P=>q(l.row)},{default:a(()=>[...e[15]||(e[15]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,U.value]]),_("div",me,[t(Q,{"current-page":p.value,"onUpdate:currentPage":e[4]||(e[4]=l=>p.value=l),"page-size":k.value,"onUpdate:pageSize":e[5]||(e[5]=l=>k.value=l),"page-sizes":[5,10,20],total:M.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:N},null,8,["current-page","page-size","total"])]),t(X,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=l=>v.value=l),title:h.value?"编辑职位":"发布职位",width:"60%"},{footer:a(()=>[_("span",pe,[t(s,{onClick:e[7]||(e[7]=l=>v.value=!1)},{default:a(()=>[...e[17]||(e[17]=[r("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:G,loading:B.value},{default:a(()=>[...e[18]||(e[18]=[r("保存",-1)])]),_:1},8,["loading"])])]),default:a(()=>[t(j,{model:g.value,"label-width":"100px"},{default:a(()=>[t(c,{label:"职位名称"},{default:a(()=>[t(W,{modelValue:g.value.title,"onUpdate:modelValue":e[6]||(e[6]=l=>g.value.title=l)},null,8,["modelValue"])]),_:1}),e[16]||(e[16]=_("div",{class:"text-center text-gray-500 my-4"}," (更多表单项待完善...) ",-1))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),_e=ie(ve,[["__scopeId","data-v-217b924c"]]);export{_e as default};
