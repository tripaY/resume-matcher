import{d as le,u as ae,r as f,x as te,m as oe,c,a as v,n as J,e as l,w as a,g as _,p as ne,y as g,t as p,s as D,o as s,F as k,z as V,i as b,k as d,b as se,A as re,h as ie,C as ue,_ as de}from"./index-CjC9TpiK.js";const ce={class:"page-container"},_e={key:0},me={class:"filter-bar"},pe={key:0},fe={class:"pagination"},ve={key:1},ge={class:"header-actions mb-4 flex justify-between items-center"},be={class:"flex items-center gap-4"},he={class:"m-0"},we={class:"font-bold"},ye={key:0},ke={class:"mb-2"},Ve=["title"],xe={key:1,class:"text-gray-400 italic"},Ce=le({__name:"ResumeList",setup(ze){const R=ie(),x=ae(),U=f(!1),$=f([]),j=f(0),h=f(1),S=f(20),E=f(!1),B=f(!1),C=f([]),w=f(null),F=f(""),n=te({city:"",level:"",skill:"",industry:"",degree:"",min_years:0}),M=async()=>{U.value=!0;const o={page:h.value,pageSize:S.value,...n};Object.keys(o).forEach(r=>{(o[r]===""||o[r]===0||o[r]===void 0)&&delete o[r]});const{data:t,error:m}=await D.getResumes(o);m?console.error(m):($.value=t.items,j.value=t.total),U.value=!1},L=()=>{h.value=1,M()},O=()=>{n.city="",n.level="",n.skill="",n.industry="",n.degree="",n.min_years=0,L()},T=o=>{h.value=o,M()},G=o=>{S.value=o,h.value=1,M()},H=o=>{R.push(`/resumes/${o}`)},K=async o=>{w.value=o.id,F.value=o.candidate_name,E.value=!0,C.value=[],await W()},Q=()=>{E.value=!1,C.value=[],w.value=null},W=async()=>{if(w.value){B.value=!0;try{const{error:o}=await D.ensureMatchEvaluations(w.value);if(o)throw o;const{data:t,error:m}=await D.getJobsForResume(w.value,{page:1,pageSize:20});if(m)throw m;C.value=t.items,C.value.forEach(async r=>{if(r.match_info.llm_score===null||r.match_info.llm_score===void 0)try{const{data:u,error:I}=await D.evaluateMatch(w.value,r.id);!I&&u&&u.success&&(r.match_info.llm_score=u.score,r.match_info.llm_reason=u.reason)}catch(u){console.error(u)}})}catch(o){ue.error("获取匹配失败: "+(o.message||o))}finally{B.value=!1}}},A=o=>o>=80?"success":o>=60?"warning":"exception";return oe(()=>{M()}),(o,t)=>{const m=_("el-option"),r=_("el-select"),u=_("el-form-item"),I=_("el-input-number"),y=_("el-button"),X=_("el-form"),i=_("el-table-column"),N=_("el-tag"),P=_("el-table"),Y=_("el-pagination"),Z=_("el-progress"),ee=_("el-icon"),q=ne("loading");return s(),c("div",ce,[E.value?(s(),c("div",ve,[v("div",ge,[v("div",be,[l(y,{icon:"Back",circle:"",onClick:Q}),v("h2",he,"岗位匹配结果: "+p(F.value),1)])]),J((s(),g(P,{data:C.value,style:{width:"100%"},stripe:"",border:""},{default:a(()=>[l(i,{label:"匹配度",width:"100",align:"center"},{default:a(e=>[l(Z,{type:"circle",percentage:e.row.match_info?.score||0,width:50,status:A(e.row.match_info?.score||0)},null,8,["percentage","status"])]),_:1}),l(i,{prop:"title",label:"职位名称",width:"180"},{default:a(e=>[v("div",we,p(e.row.title),1)]),_:1}),l(i,{prop:"city",label:"城市",width:"100"}),l(i,{label:"要求年限",width:"100"},{default:a(e=>[d(p(e.row.min_years)+"年 ",1)]),_:1}),l(i,{label:"学历要求",width:"120"},{default:a(e=>[d(p(e.row.degree_required),1)]),_:1}),l(i,{label:"薪资范围",width:"150"},{default:a(e=>[d(p(e.row.salary_min)+"-"+p(e.row.salary_max),1)]),_:1}),l(i,{label:"AI 匹配分析","min-width":"300"},{default:a(e=>[e.row.match_info?.llm_score!==void 0?(s(),c("div",ye,[v("div",ke,[l(N,{size:"small",effect:"dark",type:A(e.row.match_info.llm_score)},{default:a(()=>[d(" AI评分: "+p(e.row.match_info.llm_score),1)]),_:2},1032,["type"])]),v("div",{class:"text-sm text-gray-600 leading-relaxed line-clamp-3",title:e.row.match_info.llm_reason},p(e.row.match_info.llm_reason),9,Ve)])):(s(),c("div",xe,[l(ee,{class:"is-loading"},{default:a(()=>[l(b(re))]),_:1}),t[12]||(t[12]=d(" 分析中... ",-1))]))]),_:1}),l(i,{label:"操作",width:"120",fixed:"right"},{default:a(e=>[l(y,{type:"primary",link:"",onClick:z=>b(R).push(`/jobs/${e.row.id}`)},{default:a(()=>[...t[13]||(t[13]=[d(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,B.value]])])):(s(),c("div",_e,[v("div",me,[l(X,{inline:!0,model:n,class:"demo-form-inline"},{default:a(()=>[l(u,{label:"城市"},{default:a(()=>[l(r,{modelValue:n.city,"onUpdate:modelValue":t[0]||(t[0]=e=>n.city=e),placeholder:"选择城市",clearable:""},{default:a(()=>[(s(!0),c(k,null,V(b(x).cities,e=>(s(),g(m,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"职级"},{default:a(()=>[l(r,{modelValue:n.level,"onUpdate:modelValue":t[1]||(t[1]=e=>n.level=e),placeholder:"选择职级",clearable:""},{default:a(()=>[(s(!0),c(k,null,V(b(x).levels,e=>(s(),g(m,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"技能"},{default:a(()=>[l(r,{modelValue:n.skill,"onUpdate:modelValue":t[2]||(t[2]=e=>n.skill=e),placeholder:"具备技能",clearable:""},{default:a(()=>[(s(!0),c(k,null,V(b(x).skills,e=>(s(),g(m,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"行业"},{default:a(()=>[l(r,{modelValue:n.industry,"onUpdate:modelValue":t[3]||(t[3]=e=>n.industry=e),placeholder:"行业背景",clearable:""},{default:a(()=>[(s(!0),c(k,null,V(b(x).industries,e=>(s(),g(m,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"学历"},{default:a(()=>[l(r,{modelValue:n.degree,"onUpdate:modelValue":t[4]||(t[4]=e=>n.degree=e),placeholder:"最低学历",clearable:""},{default:a(()=>[(s(!0),c(k,null,V(b(x).degrees,e=>(s(),g(m,{key:e.id,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"最低年限"},{default:a(()=>[l(I,{modelValue:n.min_years,"onUpdate:modelValue":t[5]||(t[5]=e=>n.min_years=e),min:0,max:20},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(y,{type:"primary",onClick:L},{default:a(()=>[...t[8]||(t[8]=[d("筛选",-1)])]),_:1}),l(y,{onClick:O},{default:a(()=>[...t[9]||(t[9]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),J((s(),g(P,{data:$.value,style:{width:"100%"},stripe:""},{default:a(()=>[l(i,{prop:"id",label:"ID",width:"80"}),l(i,{prop:"candidate_name",label:"姓名",width:"120"}),l(i,{prop:"gender",label:"性别",width:"80"}),l(i,{prop:"expected_city",label:"期望城市",width:"100"}),l(i,{prop:"years_of_experience",label:"年限",width:"80"},{default:a(e=>[d(p(e.row.years_of_experience)+"年 ",1)]),_:1}),l(i,{prop:"current_level",label:"当前职级",width:"100"},{default:a(e=>[l(N,null,{default:a(()=>[d(p(e.row.current_level),1)]),_:2},1024)]),_:1}),l(i,{label:"技能","min-width":"200"},{default:a(e=>[(s(!0),c(k,null,V(e.row.skills.slice(0,3),z=>(s(),g(N,{key:z,size:"small",class:"mr-1"},{default:a(()=>[d(p(z),1)]),_:2},1024))),128)),e.row.skills.length>3?(s(),c("span",pe,"...")):se("",!0)]),_:1}),l(i,{label:"操作",width:"180",fixed:"right"},{default:a(e=>[l(y,{size:"small",onClick:z=>H(e.row.id)},{default:a(()=>[...t[10]||(t[10]=[d(" 详情 ",-1)])]),_:1},8,["onClick"]),l(y,{type:"primary",size:"small",onClick:z=>K(e.row)},{default:a(()=>[...t[11]||(t[11]=[d(" 智能匹配 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,U.value]]),v("div",fe,[l(Y,{"current-page":h.value,"onUpdate:currentPage":t[6]||(t[6]=e=>h.value=e),"page-size":S.value,"onUpdate:pageSize":t[7]||(t[7]=e=>S.value=e),"page-sizes":[5,10,20],total:j.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:T},null,8,["current-page","page-size","total"])])]))])}}}),Me=de(Ce,[["__scopeId","data-v-991c6189"]]);export{Me as default};
