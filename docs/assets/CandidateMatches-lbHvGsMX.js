import{d as x,r as w,m as S,c as d,a as u,n as B,e as o,w as r,g as f,p as D,y as N,s as l,C as m,o as c,k as v,b as V,t as b,i as $,A,_ as E}from"./index-CjC9TpiK.js";const I={class:"page-container"},R={class:"header"},z={key:0,class:"reason-section"},U={class:"reason-title"},F={class:"reason-content"},J={class:"reason-section mt-2"},T={class:"reason-title"},q={key:0},G={key:1,class:"text-gray-400 text-xs"},H={key:0,class:"reason-content"},K={key:1,class:"loading-ai"},L=x({__name:"CandidateMatches",setup(O){const g=w(!1),h=w(!1),y=w([]),C=s=>s>=80?"success":s>=60?"warning":"exception",k=async()=>{g.value=!0;const{data:{user:s}}=await l.getUser();if(!s)return;const{data:e}=await l.getMyResume(s.id);if(!e){m.warning("è¯·å…ˆå®Œå–„æ‚¨çš„ç®€åŽ†"),g.value=!1;return}const{data:i,error:_}=await l.getResumeMatches(e.id);_?m.error("èŽ·å–åŒ¹é…å¤±è´¥"):(y.value=i,y.value.forEach(async t=>{if(t.llm_score===null||t.llm_score===void 0)try{const{data:n,error:p}=await l.evaluateMatch(e.id,t.job.id);!p&&n&&n.success&&(t.llm_score=n.score,t.llm_reason=n.reason)}catch(n){console.error("Failed to evaluate match",n)}})),g.value=!1},M=async()=>{h.value=!0;try{const{data:{user:s}}=await l.getUser();if(!s)return;const{data:e}=await l.getMyResume(s.id);if(!e){m.warning("è¯·å…ˆå®Œå–„ç®€åŽ†");return}const{data:i}=await l.getJobs({page:1,pageSize:100}),_=i.items;let t=0;for(const n of _){const{error:p}=await l.evaluateMatch(e.id,n.id);p||t++}m.success(`åŒ¹é…è®¡ç®—å®Œæˆï¼ŒæˆåŠŸåŒ¹é… ${t} ä¸ªèŒä½`),k()}catch(s){console.error(s),m.error("åŒ¹é…è®¡ç®—å‡ºé”™")}finally{h.value=!1}};return S(()=>{k()}),(s,e)=>{const i=f("el-button"),_=f("el-progress"),t=f("el-table-column"),n=f("el-icon"),p=f("el-table"),j=D("loading");return c(),d("div",I,[u("div",R,[e[1]||(e[1]=u("h2",null,"èŒä½åŒ¹é…æŽ¨è",-1)),o(i,{type:"primary",loading:h.value,onClick:M},{default:r(()=>[...e[0]||(e[0]=[v("é‡æ–°è®¡ç®—åŒ¹é…",-1)])]),_:1},8,["loading"])]),B((c(),N(p,{data:y.value,style:{width:"100%"}},{default:r(()=>[o(t,{label:"åŒ¹é…åº¦",width:"100",sortable:"",prop:"score"},{default:r(({row:a})=>[o(_,{type:"circle",percentage:a.score,width:50,status:C(a.score)},null,8,["percentage","status"])]),_:1}),o(t,{prop:"job.title",label:"èŒä½åç§°",width:"200"}),o(t,{prop:"job.city",label:"åŸŽå¸‚",width:"100"}),o(t,{prop:"job.salary_range",label:"è–ªèµ„èŒƒå›´",width:"150"}),o(t,{label:"åŒ¹é…åˆ†æž"},{default:r(({row:a})=>[a.calculate_reason?(c(),d("div",z,[u("div",U,"ðŸ“Š ç¡¬æ€§æŒ‡æ ‡ ("+b(a.calculate_score)+"åˆ†)",1),u("div",F,b(a.calculate_reason),1)])):V("",!0),u("div",J,[u("div",T,[e[2]||(e[2]=v(" ðŸ¤– AI è¯„ä»· ",-1)),a.llm_score?(c(),d("span",q,"("+b(a.llm_score)+"åˆ†)",1)):(c(),d("span",G,"(åˆ†æžä¸­...)"))]),a.llm_reason?(c(),d("div",H,b(a.llm_reason),1)):(c(),d("div",K,[o(n,{class:"is-loading"},{default:r(()=>[o($(A))]),_:1}),e[3]||(e[3]=v(" AI æ­£åœ¨æ·±åº¦è§£è¯»æ‚¨çš„ç®€åŽ†... ",-1))]))])]),_:1}),o(t,{label:"æ“ä½œ",width:"120"},{default:r(({row:a})=>[o(i,{size:"small",onClick:P=>s.$router.push(`/jobs/${a.job.id}`)},{default:r(()=>[...e[4]||(e[4]=[v("è¯¦æƒ…",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,g.value]])])}}}),W=E(L,[["__scopeId","data-v-e8f7f523"]]);export{W as default};
